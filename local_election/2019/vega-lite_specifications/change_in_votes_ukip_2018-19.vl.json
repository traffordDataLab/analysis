{
  "$schema": "https://vega.github.io/schema/vega-lite/v3.json",
  "description": "Visualisation showing how the share of votes for the UK Independence Party has changed between the Trafford local elections in 2018 and 2019.",
  "autosize": {"type": "fit"},
  "width": 600,
  "height": 500,
  "title": {"text": "Change in share of UK Independence Party votes, 2018 - 2019", "offset": 20},
  "data": {
    "values": [
        {
          "area_name": "Altrincham",
          "year": 2018,
          "ballots_issued": 8266,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Ashton upon Mersey",
          "year": 2018,
          "ballots_issued": 3590,
          "ukip_vote": 53
        },
        {
          "area_name": "Bowdon",
          "year": 2018,
          "ballots_issued": 3121,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Broadheath",
          "year": 2018,
          "ballots_issued": 4218,
          "ukip_vote": 56
        },
        {
          "area_name": "Brooklands",
          "year": 2018,
          "ballots_issued": 4080,
          "ukip_vote": 55
        },
        {
          "area_name": "Bucklow-St Martins",
          "year": 2018,
          "ballots_issued": 2027,
          "ukip_vote": 90
        },
        {
          "area_name": "Clifford",
          "year": 2018,
          "ballots_issued": 3212,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Davyhulme East",
          "year": 2018,
          "ballots_issued": 3837,
          "ukip_vote": 69
        },
        {
          "area_name": "Davyhulme West",
          "year": 2018,
          "ballots_issued": 3884,
          "ukip_vote": 96
        },
        {
          "area_name": "Flixton",
          "year": 2018,
          "ballots_issued": 4562,
          "ukip_vote": 91
        },
        {
          "area_name": "Gorse Hill",
          "year": 2018,
          "ballots_issued": 2799,
          "ukip_vote": 66
        },
        {
          "area_name": "Hale Barns",
          "year": 2018,
          "ballots_issued": 2900,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Hale Central",
          "year": 2018,
          "ballots_issued": 2999,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Longford",
          "year": 2018,
          "ballots_issued": 3658,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Priory",
          "year": 2018,
          "ballots_issued": 3352,
          "ukip_vote": "NA"
        },
        {
          "area_name": "St Mary's",
          "year": 2018,
          "ballots_issued": 3432,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Sale Moor",
          "year": 2018,
          "ballots_issued": 2777,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Stretford",
          "year": 2018,
          "ballots_issued": 3130,
          "ukip_vote": 92
        },
        {
          "area_name": "Timperley",
          "year": 2018,
          "ballots_issued": 4204,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Urmston",
          "year": 2018,
          "ballots_issued": 3890,
          "ukip_vote": 138
        },
        {
          "area_name": "Village",
          "year": 2018,
          "ballots_issued": 3267,
          "ukip_vote": 106
        },
        {
          "area_name": "Altrincham",
          "year": 2019,
          "ballots_issued": 3898,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Ashton upon Mersey",
          "year": 2019,
          "ballots_issued": 3588,
          "ukip_vote": 127
        },
        {
          "area_name": "Bowdon",
          "year": 2019,
          "ballots_issued": 2929,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Broadheath",
          "year": 2019,
          "ballots_issued": 4048,
          "ukip_vote": 255
        },
        {
          "area_name": "Brooklands",
          "year": 2019,
          "ballots_issued": 3682,
          "ukip_vote": 174
        },
        {
          "area_name": "Bucklow-St Martins",
          "year": 2019,
          "ballots_issued": 1824,
          "ukip_vote": 283
        },
        {
          "area_name": "Clifford",
          "year": 2019,
          "ballots_issued": 3012,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Davyhulme East",
          "year": 2019,
          "ballots_issued": 3177,
          "ukip_vote": 253
        },
        {
          "area_name": "Davyhulme West",
          "year": 2019,
          "ballots_issued": 3197,
          "ukip_vote": 279
        },
        {
          "area_name": "Flixton",
          "year": 2019,
          "ballots_issued": 3787,
          "ukip_vote": 287
        },
        {
          "area_name": "Gorse Hill",
          "year": 2019,
          "ballots_issued": 2620,
          "ukip_vote": 212
        },
        {
          "area_name": "Hale Barns",
          "year": 2019,
          "ballots_issued": 2817,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Hale Central",
          "year": 2019,
          "ballots_issued": 2973,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Longford",
          "year": 2019,
          "ballots_issued": 3242,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Priory",
          "year": 2019,
          "ballots_issued": 3109,
          "ukip_vote": "NA"
        },
        {
          "area_name": "St Mary's",
          "year": 2019,
          "ballots_issued": 3126,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Sale Moor",
          "year": 2019,
          "ballots_issued": 2601,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Stretford",
          "year": 2019,
          "ballots_issued": 2804,
          "ukip_vote": 208
        },
        {
          "area_name": "Timperley",
          "year": 2019,
          "ballots_issued": 3918,
          "ukip_vote": "NA"
        },
        {
          "area_name": "Urmston",
          "year": 2019,
          "ballots_issued": 3394,
          "ukip_vote": 340
        },
        {
          "area_name": "Village",
          "year": 2019,
          "ballots_issued": 3217,
          "ukip_vote": 295
        }
    ]
  },
  "transform": [
    {
      "calculate": "(datum.ukip_vote/datum.ballots_issued)", "as": "vote_percentage"
    }
  ],
  "encoding": {
    "x": {
      "field": "vote_percentage",
      "type": "quantitative",
      "scale": { "domain": [0, 1] },
      "axis": {
        "title": "* Gaps due to no UKIP candidates standing in both 2018 and 2019. Source: trafford.gov.uk",
        "titleX": 270,
        "titleY": 20,
        "format": "%"
      }
    },
    "y": {
      "field": "area_name",
      "type": "nominal",
      "axis": {
        "title": null,
        "offset": 5,
        "ticks": false,
        "minExtent": 70,
        "domain": false
      }
    }
  },
  "layer": [
    {
      "mark": "line",
      "encoding": {
        "detail": {"field": "area_name", "type": "nominal"},
        "color": {"value": "#212121"},
        "size": {"value": 1}
      }
    },
    {
      "mark": {"type": "point", "filled": true},
      "encoding": {
        "color": {
          "field": "year",
          "type": "ordinal",
          "scale": {"domain": [2018, 2019], "range": ["#ccc", "#70147a"]},
          "legend": {
            "title": null,
            "orient": "bottom",
            "direction": "horizontal"
          }
        },
        "size": {"value": 100},
        "opacity": {"value": 1},
        "tooltip": [
          {"field": "vote_percentage", "type": "quantitative", "title": "Share of votes", "format": ".1%"}
        ]
      }
    }
  ],
  "config": {
    "style": {"cell": {"stroke": "transparent"}},
    "axis": {"ticks": false, "domainColor": ""}
  }
}
